color = "black"
) +
# 颜色
scale_fill_manual(values = colors[1:length(unique(df$Subclones))]) +
scale_color_manual(values = colors[1:length(unique(df$Subclones))]) +
# Y 轴
scale_y_continuous(
breaks = seq(0, 500, by = 100),
expand = expansion(mult = c(0.05, 0.15))
) +
# 标签
labs(
x = NULL,
y = "Pairwise SNPs",
title = "SNP distance between B3/H24Rx_2 and other subclones"
) +
# 主题
theme_bw() +
theme(
legend.position = "none",
aspect.ratio = 0.6,
axis.text.x = element_text(
size = 14,
colour = "black",
angle = 90,
hjust = 1,
vjust = 0.5
),
axis.text.y = element_text(size = 14, colour = "black"),
axis.title.x = element_text(size = 16, colour = "black"),
axis.title.y = element_text(size = 16, colour = "black"),
plot.title = element_text(
hjust = 0.5,
size = 16,
colour = "black"
)
)
# 设置工作目录
setwd("/Users/hewanyun/Downloads/violin")
# 加载包
library(gcookbook)
library(ggplot2)
# 读取数据
df <- read.table(
"B2.txt",
sep = "\t",
header = TRUE,
stringsAsFactors = FALSE
)
# 确保 SNPs 为数值型（关键一步）
df$SNPs <- as.numeric(df$SNPs)
df <- df[!is.na(df$SNPs), ]
# 颜色
colors <- c(
"#9B7FCB", "#95765C", "#B2BC8A",
"#ffe699", "#FECC66", "#76D5FF", "#FF7E79"
)
# 作图
p <- ggplot(df, aes(x = Subclones, y = SNPs))
p +
# 小提琴图
geom_violin(
trim = TRUE,
adjust = 2,
aes(fill = Subclones),
alpha = 0.5
) +
# 箱线图
geom_boxplot(
width = 0.1,
fill = "grey",
outlier.shape = NA
) +
# 散点
geom_jitter(
aes(color = Subclones),
width = 0.3,
size = 0.8,
alpha = 0.5
) +
# 中位数点
stat_summary(
fun = median,
geom = "point",
shape = 21,
size = 2,
fill = "white"
) +
# ⭐ 中位数数值（整数）
stat_summary(
fun = median,
geom = "text",
aes(label = sprintf("%.0f", ..y..)),
vjust = -0.8,
size = 4,
color = "black"
) +
# 颜色
scale_fill_manual(values = colors[1:length(unique(df$Subclones))]) +
scale_color_manual(values = colors[1:length(unique(df$Subclones))]) +
# Y 轴
scale_y_continuous(
breaks = seq(0, 500, by = 100),
expand = expansion(mult = c(0.05, 0.15))
) +
# 标签
labs(
x = NULL,
y = "Pairwise SNPs",
title = "SNP distance between B2/H24R and other subclones"
) +
# 主题
theme_bw() +
theme(
legend.position = "none",
aspect.ratio = 0.6,
axis.text.x = element_text(
size = 14,
colour = "black",
angle = 90,
hjust = 1,
vjust = 0.5
),
axis.text.y = element_text(size = 14, colour = "black"),
axis.title.x = element_text(size = 16, colour = "black"),
axis.title.y = element_text(size = 16, colour = "black"),
plot.title = element_text(
hjust = 0.5,
size = 16,
colour = "black"
)
)
# 设置工作目录
setwd("/Users/hewanyun/Downloads/violin")
# 加载包
library(gcookbook)
library(ggplot2)
# 读取数据
df <- read.table(
"B1.txt",
sep = "\t",
header = TRUE,
stringsAsFactors = FALSE
)
# 确保 SNPs 为数值型（关键一步）
df$SNPs <- as.numeric(df$SNPs)
df <- df[!is.na(df$SNPs), ]
# 颜色
colors <- c(
"#9B7FCB", "#95765C", "#B2BC8A",
"#ffe699", "#FECC66", "#76D5FF", "#FF7E79"
)
# 作图
p <- ggplot(df, aes(x = Subclones, y = SNPs))
p +
# 小提琴图
geom_violin(
trim = TRUE,
adjust = 2,
aes(fill = Subclones),
alpha = 0.5
) +
# 箱线图
geom_boxplot(
width = 0.1,
fill = "grey",
outlier.shape = NA
) +
# 散点
geom_jitter(
aes(color = Subclones),
width = 0.3,
size = 0.8,
alpha = 0.5
) +
# 中位数点
stat_summary(
fun = median,
geom = "point",
shape = 21,
size = 2,
fill = "white"
) +
# ⭐ 中位数数值（整数）
stat_summary(
fun = median,
geom = "text",
aes(label = sprintf("%.0f", ..y..)),
vjust = -0.8,
size = 4,
color = "black"
) +
# 颜色
scale_fill_manual(values = colors[1:length(unique(df$Subclones))]) +
scale_color_manual(values = colors[1:length(unique(df$Subclones))]) +
# Y 轴
scale_y_continuous(
breaks = seq(0, 500, by = 100),
expand = expansion(mult = c(0.05, 0.15))
) +
# 标签
labs(
x = NULL,
y = "Pairwise SNPs",
title = "SNP distance between B1/H24 and other subclones"
) +
# 主题
theme_bw() +
theme(
legend.position = "none",
aspect.ratio = 0.6,
axis.text.x = element_text(
size = 14,
colour = "black",
angle = 90,
hjust = 1,
vjust = 0.5
),
axis.text.y = element_text(size = 14, colour = "black"),
axis.title.x = element_text(size = 16, colour = "black"),
axis.title.y = element_text(size = 16, colour = "black"),
plot.title = element_text(
hjust = 0.5,
size = 16,
colour = "black"
)
)
# 设置工作目录
setwd("/Users/hewanyun/Downloads/violin")
# 加载包
library(gcookbook)
library(ggplot2)
# 读取数据
df <- read.table(
"A.txt",
sep = "\t",
header = TRUE,
stringsAsFactors = FALSE
)
# 确保 SNPs 为数值型（关键一步）
df$SNPs <- as.numeric(df$SNPs)
df <- df[!is.na(df$SNPs), ]
# 颜色
colors <- c(
"#9B7FCB", "#95765C", "#B2BC8A",
"#ffe699", "#FECC66", "#76D5FF", "#FF7E79"
)
# 作图
p <- ggplot(df, aes(x = Subclones, y = SNPs))
p +
# 小提琴图
geom_violin(
trim = TRUE,
adjust = 2,
aes(fill = Subclones),
alpha = 0.5
) +
# 箱线图
geom_boxplot(
width = 0.1,
fill = "grey",
outlier.shape = NA
) +
# 散点
geom_jitter(
aes(color = Subclones),
width = 0.3,
size = 0.8,
alpha = 0.5
) +
# 中位数点
stat_summary(
fun = median,
geom = "point",
shape = 21,
size = 2,
fill = "white"
) +
# ⭐ 中位数数值（整数）
stat_summary(
fun = median,
geom = "text",
aes(label = sprintf("%.0f", ..y..)),
vjust = -0.8,
size = 4,
color = "black"
) +
# 颜色
scale_fill_manual(values = colors[1:length(unique(df$Subclones))]) +
scale_color_manual(values = colors[1:length(unique(df$Subclones))]) +
# Y 轴
scale_y_continuous(
breaks = seq(0, 500, by = 100),
expand = expansion(mult = c(0.05, 0.15))
) +
# 标签
labs(
x = NULL,
y = "Pairwise SNPs",
title = "SNP distance between A/H53 and other subclones"
) +
# 主题
theme_bw() +
theme(
legend.position = "none",
aspect.ratio = 0.6,
axis.text.x = element_text(
size = 14,
colour = "black",
angle = 90,
hjust = 1,
vjust = 0.5
),
axis.text.y = element_text(size = 14, colour = "black"),
axis.title.x = element_text(size = 16, colour = "black"),
axis.title.y = element_text(size = 16, colour = "black"),
plot.title = element_text(
hjust = 0.5,
size = 16,
colour = "black"
)
)
# 设置工作目录
setwd("/Users/hewanyun/Downloads/violin")
# 加载包
library(gcookbook)
library(ggplot2)
# 读取数据
df <- read.table(
"B4.txt",
sep = "\t",
header = TRUE,
stringsAsFactors = FALSE
)
# 确保 SNPs 为数值型（关键一步）
df$SNPs <- as.numeric(df$SNPs)
df <- df[!is.na(df$SNPs), ]
# 颜色
colors <- c(
"#9B7FCB", "#95765C", "#B2BC8A",
"#ffe699", "#FECC66", "#76D5FF", "#FF7E79"
)
# 作图
p <- ggplot(df, aes(x = Subclones, y = SNPs))
p +
# 小提琴图
geom_violin(
trim = TRUE,
adjust = 2,
aes(fill = Subclones),
alpha = 0.5
) +
# 箱线图
geom_boxplot(
width = 0.1,
fill = "grey",
outlier.shape = NA
) +
# 散点
geom_jitter(
aes(color = Subclones),
width = 0.3,
size = 0.8,
alpha = 0.5
) +
# 中位数点
stat_summary(
fun = median,
geom = "point",
shape = 21,
size = 2,
fill = "white"
) +
# ⭐ 中位数数值（整数）
stat_summary(
fun = median,
geom = "text",
aes(label = sprintf("%.0f", ..y..)),
vjust = -0.8,
size = 4,
color = "black"
) +
# 颜色
scale_fill_manual(values = colors[1:length(unique(df$Subclones))]) +
scale_color_manual(values = colors[1:length(unique(df$Subclones))]) +
# Y 轴
scale_y_continuous(
breaks = seq(0, 500, by = 100),
expand = expansion(mult = c(0.05, 0.15))
) +
# 标签
labs(
x = NULL,
y = "Pairwise SNPs",
title = "SNP distance between B4/H24RxC and other subclones"
) +
# 主题
theme_bw() +
theme(
legend.position = "none",
aspect.ratio = 0.6,
axis.text.x = element_text(
size = 14,
colour = "black",
angle = 90,
hjust = 1,
vjust = 0.5
),
axis.text.y = element_text(size = 14, colour = "black"),
axis.title.x = element_text(size = 16, colour = "black"),
axis.title.y = element_text(size = 16, colour = "black"),
plot.title = element_text(
hjust = 0.5,
size = 16,
colour = "black"
)
)
# 设置工作目录
setwd("/Users/hewanyun/Downloads/violin")
# 加载包
library(gcookbook)
library(ggplot2)
# 读取数据
df <- read.table(
"B5.txt",
sep = "\t",
header = TRUE,
stringsAsFactors = FALSE
)
# 确保 SNPs 为数值型（关键一步）
df$SNPs <- as.numeric(df$SNPs)
df <- df[!is.na(df$SNPs), ]
# 颜色
colors <- c(
"#9B7FCB", "#95765C", "#B2BC8A",
"#ffe699", "#FECC66", "#76D5FF", "#FF7E79"
)
# 作图
p <- ggplot(df, aes(x = Subclones, y = SNPs))
p +
# 小提琴图
geom_violin(
trim = TRUE,
adjust = 2,
aes(fill = Subclones),
alpha = 0.5
) +
# 箱线图
geom_boxplot(
width = 0.1,
fill = "grey",
outlier.shape = NA
) +
# 散点
geom_jitter(
aes(color = Subclones),
width = 0.3,
size = 0.8,
alpha = 0.5
) +
# 中位数点
stat_summary(
fun = median,
geom = "point",
shape = 21,
size = 2,
fill = "white"
) +
# ⭐ 中位数数值（整数）
stat_summary(
fun = median,
geom = "text",
aes(label = sprintf("%.0f", ..y..)),
vjust = -0.8,
size = 4,
color = "black"
) +
# 颜色
scale_fill_manual(values = colors[1:length(unique(df$Subclones))]) +
scale_color_manual(values = colors[1:length(unique(df$Subclones))]) +
# Y 轴
scale_y_continuous(
breaks = seq(0, 500, by = 100),
expand = expansion(mult = c(0.05, 0.15))
) +
# 标签
labs(
x = NULL,
y = "Pairwise SNPs",
title = "SNP distance between B5/H24RxC and other subclones"
) +
# 主题
theme_bw() +
theme(
legend.position = "none",
aspect.ratio = 0.6,
axis.text.x = element_text(
size = 14,
colour = "black",
angle = 90,
hjust = 1,
vjust = 0.5
),
axis.text.y = element_text(size = 14, colour = "black"),
axis.title.x = element_text(size = 16, colour = "black"),
axis.title.y = element_text(size = 16, colour = "black"),
plot.title = element_text(
hjust = 0.5,
size = 16,
colour = "black"
)
)
